<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GC Perf — Fiches véhicules</title>

<!-- ===== Firebase SDKs (CDN compat) ===== -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
  color:#e5e7eb;
  background:#0b0f16;
  background-image:repeating-linear-gradient(45deg,rgba(255,255,255,.05)0,rgba(255,255,255,.05)1px,transparent 2px,transparent 20px);
}
header{
  display:flex;align-items:center;justify-content:space-between;
  padding:14px 20px;
  background:#0f172a;border-bottom:1px solid #1f2937;
}
.badge{background:#ef233c;color:#fff;padding:6px 14px;border-radius:999px;font-weight:700}
button,input{padding:10px;border-radius:8px;border:1px solid #243041;background:#071018;color:#e5e7eb}
button.primary{background:#ef233c;border-color:#b91c1c}
.hidden{display:none}
.card{background:#0f172a;border:1px solid #1f2937;border-radius:12px;padding:14px;margin:16px auto;max-width:800px}
</style>
</head>
<body>

<header>
  <div class="badge">GC PERF</div>
  <div>
    <button id="btnLogin" onclick="showLogin()">Connexion</button>
    <button id="btnLogout" class="hidden" onclick="logout()">Déconnexion</button>
  </div>
</header>

<main>
  <div class="card">
    <h2>Fiches Véhicules</h2>
    <p>Connectez-vous pour créer, modifier et consulter les fiches.</p>
    <button id="btnNew" class="primary hidden">+ Nouvelle fiche</button>
  </div>
</main>

<!-- Fenêtre de connexion -->
<div id="loginModal" class="hidden" style="position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center">
  <div style="background:#0f172a;padding:20px;border-radius:12px;border:1px solid #243041;min-width:320px">
    <h3>Connexion</h3>
    <label>Email</label><input id="email" type="email" style="width:100%;margin-bottom:10px">
    <label>Mot de passe</label><input id="password" type="password" style="width:100%;margin-bottom:14px">
    <div style="text-align:right">
      <button onclick="hideLogin()">Annuler</button>
      <button class="primary" onclick="login()">Connexion</button>
    </div>
    <p style="text-align:center;font-size:12px;margin-top:10px">
      <a href="#" onclick="signup()">Créer un compte</a>
    </p>
  </div>
</div>

<script>
/* ==== CONFIG FIREBASE (CDN compat) ==== */
const firebaseConfig = {
  apiKey: "AIzaSyB0dMHGvqJiwMTbbpWdNn3MdG5TVBihxqA",
  authDomain: "fiche-client-24512.firebaseapp.com",
  projectId: "fiche-client-24512",
  storageBucket: "fiche-client-24512.appspot.com",
  messagingSenderId: "808061975050",
  appId: "1:808061975050:web:0a0c7753d3c32438c2fdf3",
  measurementId: "G-3ZHE8T2XJM"
};

/* ==== INITIALISATION ==== */
firebase.initializeApp(firebaseConfig);
firebase.analytics();
const auth = firebase.auth();
const db = firebase.firestore();

/* ==== FONCTIONS ==== */
function showLogin(){ document.getElementById('loginModal').classList.remove('hidden'); }
function hideLogin(){ document.getElementById('loginModal').classList.add('hidden'); }

function login(){
  const email = document.getElementById('email').value.trim();
  const pass  = document.getElementById('password').value.trim();
  if(!email || !pass) return alert("Email et mot de passe requis !");
  auth.signInWithEmailAndPassword(email, pass)
    .then(()=>{ hideLogin(); alert("Connexion réussie ✅"); })
    .catch(err=> alert("Erreur : " + err.message));
}

function signup(){
  const email = document.getElementById('email').value.trim();
  const pass  = document.getElementById('password').value.trim();
  if(!email || !pass) return alert("Email et mot de passe requis !");
  auth.createUserWithEmailAndPassword(email, pass)
    .then(()=>{ hideLogin(); alert("Compte créé et connecté ✅"); })
    .catch(err=> alert("Erreur : " + err.message));
}

function logout(){
  auth.signOut()
    .then(()=> alert("Déconnecté"))
    .catch(err=> alert("Erreur déconnexion : " + err.message));
}

/* ==== SUIVI AUTH ==== */
auth.onAuthStateChanged(user=>{
  const logged = !!user;
  document.getElementById('btnLogin').classList.toggle('hidden', logged);
  document.getElementById('btnLogout').classList.toggle('hidden', !logged);
  document.getElementById('btnNew').classList.toggle('hidden', !logged);
});
</script>
</body>
</html>
